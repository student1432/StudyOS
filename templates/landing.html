<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>StudyOS | The Student Academic Operating System</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Newsreader:ital,opsz,wght@0,6..72,200..800;1,6..72,200..800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "os-bg": "#ffffff",
                        "os-surface": "#fafafa",
                        "os-accent": "#000000",
                        "os-grey": "#f2f2f2",
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"],
                        "serif": ["Newsreader", "serif"]
                    }
                },
            },
        }
    </script>
    
    <style type="text/tailwindcss">
        /* ===== CUSTOMIZATION GUIDE ===== */
        /* Primary Colors: Change these to rebrand */
        :root {
            --primary-gradient-start: #6b7280; /* Slate grey */
            --primary-gradient-end: #374151; /* Dark slate */
            --accent-color: #008A00; /* Vibrant Emerald */
            --accent-dark: #06402B; /* Deep Forest */
        }

        /* ===== THEME VARIABLES ===== */
        /* Default theme (light) */
        html {
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --text-primary: #000000;
            --text-secondary: rgba(0, 0, 0, 0.8);
            --border-color: rgba(0, 0, 0, 0.15);
            --accent-primary: #008A00;
            --text-muted: rgba(0, 0, 0, 0.6);
        }
        
        /* Dark theme override */
        html[data-theme="dark"] {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.9);
            --border-color: rgba(255, 255, 255, 0.2);
            --accent-primary: #06402B;
            --text-muted: rgba(255, 255, 255, 0.7);
        }
        /* ===== END THEME VARIABLES ===== */

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Central line styling */
        .central-line {
            background-color: var(--text-secondary);
            opacity: 0.3;
        }

        @layer base {
            body {
                font-family: Inter, sans-serif;
                background-color: var(--bg-primary);
                color: var(--text-primary);
                overflow-x: hidden;
                -webkit-font-smoothing: antialiased;
            }
        }
        .section-spacing {
            @apply py-[160px];
        }
        .glass-ui {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.02);
        }
        body[data-theme="dark"] .glass-ui {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(255, 255, 255, 0.02);
        }
        .glass-card {
            backdrop-filter: blur(40px);
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.02);
            transition: all 1000ms;
        }
        body[data-theme="dark"] .glass-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 50px rgba(255, 255, 255, 0.02);
        }
        .glass-card:hover {
            background: rgba(255, 255, 255, 0.6);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.04);
            transform: translateY(-8px);
        }
        body[data-theme="dark"] .glass-card:hover {
            background: rgba(0, 0, 0, 0.6);
            box-shadow: 0 30px 60px rgba(255, 255, 255, 0.04);
        }
        body[data-theme="dark"] .text-black\/50 {
            color: var(--text-secondary);
        }
        body[data-theme="dark"] .text-black\/40 {
            color: var(--text-secondary);
        }
        body[data-theme="dark"] .text-black\/30 {
            color: var(--text-secondary);
        }
        body[data-theme="dark"] .text-black\/20 {
            color: var(--text-secondary);
        }
        body[data-theme="dark"] .text-black\/60 {
            color: var(--text-primary);
        }
        /* Navbar theme styles */
        html[data-theme="light"] nav {
            background: rgba(255, 255, 255, 0.3) !important;
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        html[data-theme="dark"] nav {
            background: rgba(0, 0, 0, 0.4) !important;
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        /* Footer theme styles */
        html[data-theme="light"] footer {
            background: rgba(255, 255, 255, 0.3);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        html[data-theme="dark"] footer {
            background: rgba(0, 0, 0, 0.4);
            border-top: 1px solid rgba(255, 255, 255, 0.15);
        }
        .text-reveal {
            @apply opacity-0 translate-y-8 transition-all duration-[1500ms] ease-[cubic-bezier(0.2,1,0.3,1)];
        }
        .text-reveal.active {
            @apply opacity-100 translate-y-0;
        }
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-gradient-start) 0%, var(--primary-gradient-end) 100%);
        }
        .btn-premium {
            @apply relative overflow-hidden px-12 py-6 rounded-full text-[11px] font-bold uppercase tracking-[0.3em] transition-all duration-500 ease-out;
        }
        html[data-theme="light"] .btn-premium {
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        html[data-theme="dark"] .btn-premium {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }
        html[data-theme="light"] .btn-premium:hover {
            background: rgba(0, 0, 0, 1);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        html[data-theme="dark"] .btn-premium:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.1);
        }
        
        /* Main heading styling */
        .main-heading {
            color: var(--text-primary);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        html[data-theme="dark"] .main-heading {
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 50%, #e0e0e0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Fix light font in dark mode */
        html[data-theme="dark"] .main-heading .italic {
            opacity: 0.9 !important;
            -webkit-text-fill-color: rgba(255, 255, 255, 0.9) !important;
        }
        
        /* Animated gradient background */
        .animated-gradient {
            background: linear-gradient(-45deg, #f5f5f5, #707070, #899a96, #f5f5f5);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        html[data-theme="dark"] .animated-gradient {
            background: linear-gradient(-45deg, #0a0a0a, #1a1a1a, #2a2a2a, #0a0a0a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        /* Fallback background */
        .fallback-gradient {
            background: linear-gradient(-45deg, #f5f5f5, #707070, #899a96, #f5f5f5);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        html[data-theme="dark"] .fallback-gradient {
            background: linear-gradient(-45deg, #0a0a0a, #1a1a1a, #2a2a2a, #0a0a0a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Features section background */
        .features-bg {
            background: linear-gradient(135deg, rgba(250, 250, 250, 0.5) 0%, rgba(240, 240, 240, 0.3) 100%);
        }
        html[data-theme="dark"] .features-bg {
            background: linear-gradient(135deg, rgba(15, 15, 15, 0.5) 0%, rgba(20, 20, 20, 0.3) 100%);
        }
    </style>
</head>
<body>
<div id="grainient-container" style="width: 100%; height: 100vh; position: fixed; top: 0; left: 0; z-index: -1;"></div>
<div class="fallback-gradient fixed inset-0 -z-20" id="fallback-bg"></div>


<nav class="fixed top-0 w-full z-50 px-8 py-4 flex justify-between items-center backdrop-blur-xl transition-all duration-300" id="navbar">
<div class="flex items-center gap-3">
<div class="w-2.5 h-2.5 bg-gradient-to-r from-green-500 to-green-700 rounded-full accent-element"></div>
<span class="text-[11px] font-bold tracking-[0.4em] uppercase">StudyOS</span>
</div>
<div class="hidden lg:flex gap-12 text-[8px] font-bold uppercase tracking-[0.5em] theme-text-secondary">
<a class="hover:text-black transition-colors" href="#features">Features</a>
<a class="hover:text-black transition-colors" href="#institutions">Institutions</a>
<a class="hover:text-black transition-colors" href="#enterprise">Enterprise</a>
</div>
<div class="flex items-center gap-3">
<button class="w-8 h-8 rounded-full border border-black/10 flex items-center justify-center hover:scale-110 transition-all group theme-text-secondary" id="themeToggle">
<span class="material-symbols-outlined text-[16px] group-hover:rotate-90 transition-transform duration-500">light_mode</span>
</button>
<a href="{{ url_for('login') }}" class="btn-premium text-xs px-6 py-3">
Login
</a>
<a href="{{ url_for('signup') }}" class="btn-premium text-xs px-6 py-3">
Sign Up
</a>
</div>
</nav>
<main class="relative z-10">
<section class="min-h-screen flex flex-col justify-center px-12 lg:px-24 max-w-7xl pt-32">
<div class="max-w-3xl">
<h1 class="font-serif text-[clamp(3.5rem,8vw,6.5rem)] leading-[0.95] tracking-tight main-heading mb-12 text-reveal" style="transition-delay: 200ms;">
                    StudyOS: <span class="italic font-light opacity-60">The Student Academic Operating System.</span>
</h1>
<p class="text-2xl font-light theme-text-secondary max-w-xl mb-16 leading-relaxed text-reveal" style="transition-delay: 400ms;">
                    A unified infrastructure for academics, habits, institutions, and direction.
                </p>
<div class="flex flex-wrap gap-8 justify-start text-reveal" style="transition-delay: 600ms;">
<a href="{{ url_for('login') }}" class="btn-premium text-xs px-8 py-4 shadow-lg shadow-black/10">
                        Access Dashboard
                    </a>
<a href="#features" class="btn-premium text-xs px-8 py-4 shadow-lg shadow-black/5">
                        Learn More
                    </a>
</div>
</div>
</section>
<section class="section-spacing consolidation-bg" id="features">
<div class="max-w-5xl mx-auto px-12 text-center text-reveal">
<span class="text-[10px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-12 block">CONSOLIDATION</span>
<h2 class="font-serif text-5xl md:text-6xl italic font-light leading-[1.2] theme-text-primary">
                    Notes. Timers. Dashboards. Portals. <br/>
<span class="not-italic font-normal">Replaced by a Monolithic System.</span>
</h2>
<div class="mt-20 flex flex-col items-center gap-6">
<div class="h-16 w-[1px] central-line"></div>
</div>
</div>
</section>
<section class="section-spacing px-12 lg:px-24" id="pillarsSection">
<div class="flex flex-col lg:flex-row justify-between items-start gap-24 mb-32">
<div class="max-w-2xl">
<span class="text-[10px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-8 block">SYSTEM SNAPSHOT</span>
<h3 class="font-serif text-6xl lg:text-7xl mb-10 leading-tight">The Four Pillars</h3>
<p class="text-xl theme-text-secondary font-light leading-relaxed">StudyOS's architecture is built on four core foundations designed for comprehensive academic management.</p>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-5xl">
<div class="glass-card p-14 rounded-[3rem] group cursor-pointer pillar-card">
<div class="flex justify-between items-start mb-20">
<span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">01 / Profile</span>
<span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors">badge</span>
</div>
<h4 class="font-serif text-4xl mb-6">Identity</h4>
<p class="text-sm theme-text-secondary leading-relaxed font-light">Professional Hub, Resume Generation, & Achievement Tracking.</p>
</div>
<div class="glass-card p-14 rounded-[3rem] group cursor-pointer pillar-card">
<div class="flex justify-between items-start mb-20">
<span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">02 / Knowledge</span>
<span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors">menu_book</span>
</div>
<h4 class="font-serif text-4xl mb-6">Academics</h4>
<p class="text-sm theme-text-secondary leading-relaxed font-light">Dynamic Syllabus Engine & Real-time Progress Tracking.</p>
</div>
<div class="glass-card p-14 rounded-[3rem] group cursor-pointer pillar-card">
<div class="flex justify-between items-start mb-20">
<span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">03 / Utility</span>
<span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors">bolt</span>
</div>
<h4 class="font-serif text-4xl mb-6">Execution</h4>
<p class="text-sm theme-text-secondary leading-relaxed font-light">Goals, Tasks, & Study Mode with Pomodoro Analytics.</p>
</div>
<div class="glass-card p-14 rounded-[3rem] group cursor-pointer pillar-card">
<div class="flex justify-between items-start mb-20">
<span class="text-[11px] font-black uppercase tracking-[0.4em] theme-text-secondary group-hover:theme-text-primary transition-colors">04 / Network</span>
<span class="material-symbols-outlined theme-text-secondary group-hover:theme-text-primary transition-colors">domain</span>
</div>
<h4 class="font-serif text-4xl mb-6">Institutions</h4>
<p class="text-sm theme-text-secondary leading-relaxed font-light">Administrative Dashboards, Teacher Portals, & Cohort Management.</p>
</div>
</div>
</section>
<section class="section-spacing features-bg" id="institutions">
<div class="max-w-6xl mx-auto px-12">
<div class="text-center mb-24 text-reveal">
<span class="text-[11px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-4 block">CORE CAPABILITIES</span>
<h3 class="font-serif text-5xl">Engineered Features</h3>
</div>
<div class="flex flex-wrap justify-center gap-6 max-w-4xl mx-auto">
<span class="px-10 py-5 glass-ui rounded-full text-[10px] font-bold tracking-[0.4em] uppercase hover:bg-black hover:text-white transition-all cursor-default">Academic Progress</span>
<span class="px-10 py-5 glass-ui rounded-full text-[10px] font-bold tracking-[0.4em] uppercase hover:bg-black hover:text-white transition-all cursor-default">Study Execution</span>
<span class="px-10 py-5 glass-ui rounded-full text-[10px] font-bold tracking-[0.4em] uppercase hover:bg-black hover:text-white transition-all cursor-default">Master Library</span>
<span class="px-10 py-5 glass-ui rounded-full text-[10px] font-bold tracking-[0.4em] uppercase hover:bg-black hover:text-white transition-all cursor-default">Career Discovery</span>
<span class="px-10 py-5 glass-ui rounded-full text-[10px] font-bold tracking-[0.4em] uppercase hover:bg-black hover:text-white transition-all cursor-default">Institutional Management</span>
<span class="px-10 py-5 glass-ui rounded-full text-[10px] font-bold tracking-[0.4em] uppercase hover:bg-black hover:text-white transition-all cursor-default">Risk Analytics</span>
</div>
</div>
</section>
<section class="section-spacing px-12" id="enterprise">
<div class="max-w-7xl mx-auto glass-card rounded-[5rem] p-24 lg:p-40 relative overflow-hidden">
<div class="absolute inset-0 bg-gradient-to-br from-black/[0.01] to-transparent pointer-events-none"></div>
<div class="relative z-10 text-center">
<span class="text-[11px] font-bold tracking-[0.5em] uppercase theme-text-secondary mb-8 block">ENTERPRISE GRADE</span>
<h2 class="font-serif text-6xl lg:text-7xl mb-12 max-w-4xl mx-auto leading-tight">Built for Scale.</h2>
<p class="text-2xl font-light theme-text-secondary max-w-3xl mx-auto mb-20 leading-relaxed">
                        Institutional Tier with administrative oversight, behavioral heatmaps, and secure role-based access.
                    </p>
<div class="flex flex-col sm:flex-row gap-8 justify-center items-center">
<a href="{{ url_for('login') }}" class="btn-premium bg-black text-white px-20">Request Institutional Access</a>
<a href="#features" class="btn-premium border border-black/10 px-20">View Case Studies</a>
</div>
</div>
</div>
</section>
</main>
<footer class="py-24 px-12 lg:px-24 bg-white border-t border-black/[0.03] flex flex-col md:flex-row justify-between items-center gap-16 relative z-20">
<div class="flex items-center gap-4">
<div class="fixed top-0 left-0 h-1 bg-gradient-to-r from-green-500 to-green-700 z-[100] transition-all duration-300" id="scrollIndicator" style="width: 100%; transform: translateX(-100%)"></div>
<span class="text-[11px] font-bold tracking-[0.5em] uppercase theme-text-primary">StudyOS / v2.1.0</span>
</div>
<div class="flex flex-wrap justify-center gap-12 lg:gap-24">
<a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Ethics</a>
<a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Privacy</a>
<a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Documentation</a>
<a class="text-[10px] uppercase tracking-[0.4em] theme-text-secondary hover:theme-text-primary transition-colors" href="#">Manifesto</a>
</div>
<span class="text-[10px] uppercase tracking-[0.5em] theme-text-secondary italic font-serif text-center md:text-right">
            Designed as long-term academic infrastructure.
        </span>
</footer>
<script>
        window.addEventListener('scroll', () => {
            const scrolled = window.scrollY;
            const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = (scrolled / totalHeight) * 100;
            const scrollIndicator = document.getElementById('scrollIndicator');
            
            // Smooth scroll indicator animation
            scrollIndicator.style.transform = `translateX(${scrollPercent - 100}%)`;

            document.querySelectorAll('.text-reveal').forEach(el => {
                const elRect = el.getBoundingClientRect();
                if (elRect.top < window.innerHeight * 0.85) {
                    el.classList.add('active');
                }
            });

            // Navbar background transition on scroll
            const navbar = document.getElementById('navbar');
            const currentTheme = document.documentElement.getAttribute('data-theme');
            
            // Always maintain glass effect, just change opacity on scroll
            if (scrolled > 50) {
                if (currentTheme === 'dark') {
                    navbar.style.background = 'rgba(0, 0, 0, 0.6)';
                    navbar.style.backdropFilter = 'blur(20px)';
                } else {
                    navbar.style.background = 'rgba(255, 255, 255, 0.5)';
                    navbar.style.backdropFilter = 'blur(20px)';
                }
            } else {
                // Reset to initial glass state
                if (currentTheme === 'dark') {
                    navbar.style.background = 'rgba(0, 0, 0, 0.4)';
                    navbar.style.backdropFilter = 'blur(12px)';
                } else {
                    navbar.style.background = 'rgba(255, 255, 255, 0.3)';
                    navbar.style.backdropFilter = 'blur(12px)';
                }
            }
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        const body = document.body;
        const themeIcon = themeToggle.querySelector('span');

        // Load saved theme
        const savedTheme = localStorage.getItem('studyos-theme') || 'light';
        html.setAttribute('data-theme', savedTheme);
        body.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            body.setAttribute('data-theme', newTheme);
            localStorage.setItem('studyos-theme', newTheme);
            updateThemeIcon(newTheme);
            
            // Update Grainient colors when theme changes
            updateGrainientColors();
        });

        function updateGrainientColors() {
            // This function will be called to update the Grainient shader colors
            // The setUniforms function already handles theme detection
            console.log('Theme changed, Grainient colors will update on next frame');
        }

        function updateThemeIcon(theme) {
            themeIcon.textContent = theme === 'dark' ? 'dark_mode' : 'light_mode';
            themeIcon.className = 'material-symbols-outlined text-[20px] group-hover:rotate-90 transition-transform duration-500';
        }

        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        window.dispatchEvent(new Event('scroll'));

        // Grainient Background Effect - Vanilla WebGL Implementation
        const hexToRgb = hex => {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            if (!result) return [1, 1, 1];
            return [parseInt(result[1], 16) / 255, parseInt(result[2], 16) / 255, parseInt(result[3], 16) / 255];
        };

        const vertexShaderSource = `
            attribute vec2 a_position;
            void main() {
                gl_Position = vec4(a_position, 0.0, 1.0);
            }
        `;

        const fragmentShaderSource = `
            precision highp float;
            uniform vec2 u_resolution;
            uniform float u_time;
            uniform float u_timeSpeed;
            uniform float u_colorBalance;
            uniform float u_warpStrength;
            uniform float u_warpFrequency;
            uniform float u_warpSpeed;
            uniform float u_warpAmplitude;
            uniform float u_blendAngle;
            uniform float u_blendSoftness;
            uniform float u_rotationAmount;
            uniform float u_noiseScale;
            uniform float u_grainAmount;
            uniform float u_grainScale;
            uniform float u_grainAnimated;
            uniform float u_contrast;
            uniform float u_gamma;
            uniform float u_saturation;
            uniform vec2 u_centerOffset;
            uniform float u_zoom;
            uniform vec3 u_color1;
            uniform vec3 u_color2;
            uniform vec3 u_color3;
            
            #define S(a,b,t) smoothstep(a,b,t)
            
            mat2 Rot(float a){
                float s=sin(a),c=cos(a);
                return mat2(c,-s,s,c);
            } 
            
            vec2 hash(vec2 p){
                p=vec2(dot(p,vec2(2127.1,81.17)),dot(p,vec2(1269.5,283.37)));
                return fract(sin(p)*43758.5453);
            } 
            
            float noise(vec2 p){
                vec2 i=floor(p),f=fract(p),u=f*f*(3.0-2.0*f);
                float n=mix(
                    mix(dot(-1.0+2.0*hash(i+vec2(0.0,0.0)),f-vec2(0.0,0.0)),
                        dot(-1.0+2.0*hash(i+vec2(1.0,0.0)),f-vec2(1.0,0.0)),u.x),
                    mix(dot(-1.0+2.0*hash(i+vec2(0.0,1.0)),f-vec2(0.0,1.0)),
                        dot(-1.0+2.0*hash(i+vec2(1.0,1.0)),f-vec2(1.0,1.0)),u.x),u.y);
                return 0.5+0.5*n;
            }
            
            void main() {
                float t = u_time * u_timeSpeed;
                vec2 uv = gl_FragCoord.xy / u_resolution.xy;
                float ratio = u_resolution.x / u_resolution.y;
                vec2 tuv = uv - 0.5 + u_centerOffset;
                tuv /= max(u_zoom, 0.001);

                float degree = noise(vec2(t * 0.1, tuv.x * tuv.y) * u_noiseScale);
                tuv.y *= 1.0 / ratio;
                tuv *= Rot(radians((degree - 0.5) * u_rotationAmount + 180.0));
                tuv.y *= ratio;

                float frequency = u_warpFrequency;
                float ws = max(u_warpStrength, 0.001);
                float amplitude = u_warpAmplitude / ws;
                float warpTime = t * u_warpSpeed;
                tuv.x += sin(tuv.y * frequency + warpTime) / amplitude;
                tuv.y += sin(tuv.x * (frequency * 1.5) + warpTime) / (amplitude * 0.5);

                vec3 colLav = u_color1;
                vec3 colOrg = u_color2;
                vec3 colDark = u_color3;
                float b = u_colorBalance;
                float s = max(u_blendSoftness, 0.0);
                mat2 blendRot = Rot(radians(u_blendAngle));
                float blendX = (tuv * blendRot).x;
                float edge0 = -0.3 - b - s;
                float edge1 = 0.2 - b + s;
                float v0 = 0.5 - b + s;
                float v1 = -0.3 - b - s;
                vec3 layer1 = mix(colDark, colOrg, S(edge0, edge1, blendX));
                vec3 layer2 = mix(colOrg, colLav, S(edge0, edge1, blendX));
                vec3 col = mix(layer1, layer2, S(v0, v1, tuv.y));

                vec2 grainUv = uv * max(u_grainScale, 0.001);
                if(u_grainAnimated > 0.5){
                    grainUv += vec2(u_time * 0.05);
                } 
                float grain = fract(sin(dot(grainUv, vec2(12.9898, 78.233))) * 43758.5453);
                col += (grain - 0.5) * u_grainAmount;

                col = (col - 0.5) * u_contrast + 0.5;
                float luma = dot(col, vec3(0.2126, 0.7152, 0.0722));
                col = mix(vec3(luma), col, u_saturation);
                col = pow(max(col, 0.0), vec3(1.0 / max(u_gamma, 0.001)));
                col = clamp(col, 0.0, 1.0);

                gl_FragColor = vec4(col, 1.0);
            }
        `;

        function initGrainient() {
            console.log('Initializing Grainient with Vanilla WebGL...');
            const container = document.getElementById('grainient-container');
            if (!container) {
                console.error('Grainient container not found');
                return;
            }

            try {
                const canvas = document.createElement('canvas');
                canvas.style.width = '100%';
                canvas.style.height = '100%';
                canvas.style.display = 'block';
                container.appendChild(canvas);

                const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');
                if (!gl) {
                    throw new Error('WebGL not supported');
                }

                // Create shaders
                const vertexShader = gl.createShader(gl.VERTEX_SHADER);
                gl.shaderSource(vertexShader, vertexShaderSource);
                gl.compileShader(vertexShader);

                const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
                gl.shaderSource(fragmentShader, fragmentShaderSource);
                gl.compileShader(fragmentShader);

                // Create program
                const program = gl.createProgram();
                gl.attachShader(program, vertexShader);
                gl.attachShader(program, fragmentShader);
                gl.linkProgram(program);

                if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
                    throw new Error('Failed to link shader program');
                }

                // Set up geometry (full screen triangle)
                const positions = new Float32Array([
                    -1, -1,
                     3, -1,
                    -1,  3
                ]);

                const positionBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
                gl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);

                // Get attribute and uniform locations
                const positionAttributeLocation = gl.getAttribLocation(program, 'a_position');
                const resolutionUniformLocation = gl.getUniformLocation(program, 'u_resolution');
                const timeUniformLocation = gl.getUniformLocation(program, 'u_time');

                // Set uniforms
                const setUniforms = () => {
                    gl.useProgram(program);
                    gl.uniform2f(resolutionUniformLocation, canvas.width, canvas.height);
                    gl.uniform1f(timeUniformLocation, performance.now() * 0.001);
                    
                    // Get current theme
                    const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                    
                    // Set theme-specific colors
                    let color1, color2, color3;
                    if (currentTheme === 'dark') {
                        color1 = hexToRgb('#2d3748');  // Dark grey
                        color2 = hexToRgb('#475569');  // Medium dark
                        color3 = hexToRgb('#64748b');  // Lighter dark
                    } else {
                        color1 = hexToRgb('#ffffff');  // Pure white
                        color2 = hexToRgb('#f0f0f0');  // Light grey
                        color3 = hexToRgb('#e2e8f0');  // Lighter grey
                    }
                    
                    gl.uniform1f(gl.getUniformLocation(program, 'u_timeSpeed'), 0.5);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_colorBalance'), 0.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_warpStrength'), 1.5);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_warpFrequency'), 3.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_warpSpeed'), 3.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_warpAmplitude'), 30.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_blendAngle'), 0.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_blendSoftness'), 0.05);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_rotationAmount'), 300.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_noiseScale'), 1.5);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_grainAmount'), 0.25);  
                    gl.uniform1f(gl.getUniformLocation(program, 'u_grainScale'), 3.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_grainAnimated'), 0.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_contrast'), 1.2);  
                    gl.uniform1f(gl.getUniformLocation(program, 'u_gamma'), 1.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_saturation'), 1.0);  
                    gl.uniform2f(gl.getUniformLocation(program, 'u_centerOffset'), 0.0, 0.0);
                    gl.uniform1f(gl.getUniformLocation(program, 'u_zoom'), 0.8);  
                    
                    gl.uniform3fv(gl.getUniformLocation(program, 'u_color1'), color1);
                    gl.uniform3fv(gl.getUniformLocation(program, 'u_color2'), color2);
                    gl.uniform3fv(gl.getUniformLocation(program, 'u_color3'), color3);
                };

                // Resize function
                const resize = () => {
                    canvas.width = container.clientWidth;
                    canvas.height = container.clientHeight;
                    gl.viewport(0, 0, canvas.width, canvas.height);
                };

                // Animation loop
                const render = () => {
                    resize();
                    setUniforms();
                    
                    gl.clearColor(0, 0, 0, 1);
                    gl.clear(gl.COLOR_BUFFER_BIT);
                    
                    gl.useProgram(program);
                    gl.enableVertexAttribArray(positionAttributeLocation);
                    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
                    gl.vertexAttribPointer(positionAttributeLocation, 2, gl.FLOAT, false, 0, 0);
                    
                    gl.drawArrays(gl.TRIANGLES, 0, 3);
                    
                    requestAnimationFrame(render);
                };

                // Start animation
                render();
                console.log('Grainient WebGL animation started successfully!');
                
                // Hide fallback background
                const fallbackBg = document.getElementById('fallback-bg');
                if (fallbackBg) {
                    fallbackBg.style.display = 'none';
                }

            } catch (error) {
                console.error('Error initializing Grainient WebGL:', error);
                // Keep fallback background visible if WebGL fails
            }
        }

        // Initialize Grainient when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGrainient);
        } else {
            initGrainient();
        }
    </script>

</body>
</html>