<aside class="sidebar" id="mainSidebar">
    <!-- Material Symbols Font for icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    
    <div class="sidebar-header">
        <div class="sidebar-header-content">
            <button class="sidebar-collapse-btn" id="sidebarCollapseBtn" title="Collapse sidebar">
                <span class="material-symbols-outlined">chevron_left</span>
            </button>
            <a href="{{ url_for('profile_dashboard') }}" class="sidebar-user-link">{{ name or (user.get('name') if user else None) or 'Student' }}</a>
        </div>
    </div>
    <nav class="sidebar-nav">
        {% set p = request.path %}
        <a href="{{ url_for('profile_dashboard') }}"
            class="nav-item {% if p == '/dashboard' or p == '/profile' or p == '/' %}active{% endif %}">Home</a>
        <a href="{{ url_for('academic_dashboard') }}"
            class="nav-item {% if p.startswith('/academic') %}active{% endif %}">Academic</a>
        <a href="{{ url_for('study_mode') }}"
            class="nav-item {% if p.startswith('/study-mode') %}active{% endif %}">Study Mode</a>
        <a href="{{ url_for('ai_assistant') }}"
            class="nav-item {% if p.startswith('/ai-assistant') %}active{% endif %}">AI Assistant</a>
        <a href="{{ url_for('interests_dashboard') }}"
            class="nav-item {% if p.startswith('/interests') or p.startswith('/career') or p.startswith('/course') or p.startswith('/internship') or p.startswith('/careers') or p.startswith('/courses') or p.startswith('/internships') %}active{% endif %}">Interests</a>
        <a href="{{ url_for('master_library') }}"
            class="nav-item {% if p.startswith('/master-library') %}active{% endif %}">Master Library</a>
        <a href="{{ url_for('statistics_dashboard') }}"
            class="nav-item {% if p.startswith('/statistics') %}active{% endif %}">Statistics</a>
        <a href="{{ url_for('community_dashboard') }}"
            class="nav-item {% if p.startswith('/community') %}active{% endif %}">Community</a>
        <a href="{{ url_for('student_files') }}" class="nav-item {% if p.startswith('/student') %}active{% endif %}">Class Files</a>
    </nav>
    <div class="sidebar-footer">
        <a id="themeToggle" class="nav-item" style="cursor:pointer;">
            Toggle theme
        </a>
        <a href="{{ url_for('student_join_class') }}" class="nav-item">Join Class</a>
        
        <a href="{{ url_for('settings') }}" class="nav-item">Settings</a>
        <a href="{{ url_for('contact') }}" class="nav-item">Contact</a>
        <a href="{{ url_for('logout') }}" class="nav-item">Logout</a>
    </div>

    <script>
        // Sidebar collapse functionality
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('mainSidebar');
            const collapseBtn = document.getElementById('sidebarCollapseBtn');
            const mainContent = document.querySelector('.main-content');

            if (!sidebar || !collapseBtn || !mainContent) return;

            // Load saved sidebar state
            const isCollapsed = localStorage.getItem('sidebar-collapsed') === 'true';

            // Apply initial state
            if (isCollapsed) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('sidebar-collapsed');
                const chevron = collapseBtn.querySelector('.material-symbols-outlined');
                if (chevron) chevron.textContent = 'chevron_right';
            }

            // Toggle functionality
            collapseBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();

                const isCurrentlyCollapsed = sidebar.classList.contains('collapsed');
                const chevron = this.querySelector('.material-symbols-outlined');

                if (isCurrentlyCollapsed) {
                    // Expand sidebar
                    sidebar.classList.remove('collapsed');
                    mainContent.classList.remove('sidebar-collapsed');
                    if (chevron) chevron.textContent = 'chevron_left';
                    localStorage.setItem('sidebar-collapsed', 'false');
                } else {
                    // Collapse sidebar
                    sidebar.classList.add('collapsed');
                    mainContent.classList.add('sidebar-collapsed');
                    if (chevron) chevron.textContent = 'chevron_right';
                    localStorage.setItem('sidebar-collapsed', 'true');
                }
            });
        });
    </script>
</aside>
